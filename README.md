KinectV2TVInteraction


### ГАЙД ПО УСТАНОВКЕ
Прописан на странице [релиза](https://github.com/RTUITLab/KinectV2TVInteraction/releases)/

Сожержание проекта:
* `Games` - папка с играми;
* `Videos` - папка с видеозаписями;
* `Videos\Background` - папка с фоновыми видеозаписями;
* `TimeTables` - папка с расписанием института;
* `Settings` - папка настроек;
* `ControlsBasics-WPF.exe` - исполняемый файл проекта.

В директории приложения есть папка `Settings`. Внутри нее лежат два `.json` файла: `news.json` и `settings.json`. Файл `news.json` нужен для кеширования новостей с сайта вуза. Файл `settings.json` внутри себя имеет следующую структуру:
* `time` - включение режима ночной работы приложения (ночью работает герб МИРЭА вместо видео). Значение: `true`/`false`.
* `admin` - включения режима админского управления, включающего в себя: возможность выключения через *alt+F4* и работу мышки. Значение: `true`/`false`.
* `volume` - установление уровня громкости всех видеозаписей в приложении. Значение: от **0** до **100**.
* `MinForUpdate` - установка частоты обновления новостей с сайта вуза. Значение: задержка в минутах от **5** мин.

В папке `Games` находятся игры которые можно добавлять. Единственное требование это создать внутри папки Games папку название которой будет названием панельки в самом приложении. Внутри папки с названием игры должен лежать собранный проект с исполняемым файлом игры(.exe). Важно что exe файл может называться как угодно. Самое важно это название папки в которой лежит билд игры.

В папке `TimeTable` лежащей сразу после корня проекта необходимо разместить расписание в формате png(для получение из excel файла png можно воспользоваться любым онлайн конвертером). Приняты следующте обозначения для файлов расписания:
1.png - расписание первого курса бакалавриата

2.png - расписание второго курса бакалавриата

3.png - расписание третьего курса бакалавриата

4.png - расписание четвертого курса бакалавриата

5.png - расписание первого курса магистратуры

6.png - расписание второго курса магистратуры

Так же для работы видеозаписей используется папка `Videos`. В ней храняться все видеозаписи телевизора, где название видеофайла является названием панельки видео в программе.

Чтобы добавить видео для фонового проигрывания (режим бездействия), нужно поместить видео ролики в папку `Videos\Background`.

ПРИЛОЖЕНИЕ ЗАКРЫВАЕТСЯ ТОЛЬКО ЧЕРЕЗ ДИСПЕТЧЕР УСТРОЙСТВ !!! АЛЬТЕРНАТИВНЫЕ МЕТОДЫ (типо Alt+F4) не работают (если в настройках не стоит режим админа).

## Кража фокуса экрана другими приложениями
Для модуля KinectControls необходимо наличие фокуса на экране. При отсутствии фокуса на нем вы не сможете взаимодействовать с решением и оно просто не будет реагировать на ввод.

В системе Windows очень часть сторонние приложения запускаемые по таймеру или любому другому тригеру производят эффект, называемый "Stilling Focus". Как описано выше при открытии любого окна поверх приложения оно будет не активно

Для решения данной проблемы мы рекомендуем использовать решение [Turbotop](https://www.savardsoftware.com/turbotop/). Оно достаточно легковесное и позволит вам выбрать в нем окно приложения как активно, что защитит его от кражи фокуса и оно всегда будет воспроизводиться OnTop.
